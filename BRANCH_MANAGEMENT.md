# åˆ†æ”¯ç®¡ç†ç­–ç•¥ (Branch Management Strategy)

## ğŸ“‹ åˆ†æ”¯æ¦‚è¿°

æœ¬é¡¹ç›®é‡‡ç”¨å¤šåˆ†æ”¯å¼€å‘æ¨¡å¼ï¼Œæ¯ä¸ªåˆ†æ”¯éƒ½æœ‰ç‰¹å®šçš„ç”¨é€”å’Œç®¡ç†è§„åˆ™ã€‚

## ğŸŒ¿ åˆ†æ”¯ç»“æ„

### 1. `main` åˆ†æ”¯ (ä¸»åˆ†æ”¯)
- **ç”¨é€”**: ç”Ÿäº§ç¯å¢ƒç¨³å®šä»£ç 
- **ç‰¹ç‚¹**: ç›¸å¯¹ç¨³å®šï¼Œä½†é€šå¸¸è½åäºdevï¼Œé¢†å…ˆäºreleaseç‰ˆæœ¬
- **è§„åˆ™**: 
  - åªæ¥å—æ¥è‡ªdevåˆ†æ”¯ç»è¿‡æµ‹è¯•çš„PR
  - ç¦æ­¢ç›´æ¥æ¨é€
  - æ‰€æœ‰åˆå¹¶å¿…é¡»ç»è¿‡ä»£ç å®¡æŸ¥
  - ä¿æŠ¤åˆ†æ”¯è®¾ç½®

### 2. `dev` åˆ†æ”¯ (å¼€å‘åˆ†æ”¯)
- **ç”¨é€”**: æ—¥å¸¸å¼€å‘å’ŒåŠŸèƒ½é›†æˆ
- **ç‰¹ç‚¹**: æ‹¥æœ‰æœ€å®½æ¾çš„ç‰ˆæœ¬ç®¡ç†ï¼Œå…è®¸å­˜åœ¨é‡å¤§BUGï¼Œæœ€æ–°çš„ç‰ˆæœ¬
- **è§„åˆ™**:
  - æ–°åŠŸèƒ½å¼€å‘çš„é›†æˆç‚¹
  - å¯ä»¥åŒ…å«æœªå®Œå…¨æµ‹è¯•çš„åŠŸèƒ½
  - å®šæœŸåˆå¹¶åˆ°mainåˆ†æ”¯
  - è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆ

### 3. `deploy` åˆ†æ”¯ (éƒ¨ç½²åˆ†æ”¯) ğŸ†• å·²ä¼˜åŒ–
- **ç”¨é€”**: ä¸“é—¨ç”¨äºCloudflare Workerså‰ç«¯éƒ¨ç½²
- **ç‰¹ç‚¹**: 
  - **åªåŒ…å«å‰ç«¯ä»£ç **
  - **å·²ç§»é™¤åç«¯ä»£ç å’ŒDockerç›¸å…³å†…å®¹**
  - é’ˆå¯¹Cloudflare Workersä¼˜åŒ–
- **è§„åˆ™**:
  - ä»mainåˆ†æ”¯å®šæœŸåŒæ­¥å‰ç«¯å˜æ›´
  - ä¸“æ³¨äºå‰ç«¯éƒ¨ç½²é…ç½®
  - ç‹¬ç«‹çš„éƒ¨ç½²æµæ°´çº¿

### 4. `release/x.x.x` åˆ†æ”¯ (å‘å¸ƒåˆ†æ”¯)
- **ç”¨é€”**: æ­£å¼å‘å¸ƒç‰ˆæœ¬
- **ç‰¹ç‚¹**: é€šè¿‡åå•†æˆ–æ‹¥æœ‰è€…å†³å®šçš„ç¨³å®šå‘è¡Œç‰ˆï¼Œé€šå¸¸ç”±mainç‰ˆæœ¬mergeå¾—æ¥
- **è§„åˆ™**:
  - ä»mainåˆ†æ”¯åˆ›å»º
  - åªå…è®¸å…³é”®bugä¿®å¤
  - å‘å¸ƒåæ‰“æ ‡ç­¾
  - ä¿æŠ¤åˆ†æ”¯ï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹

## ğŸ”„ å·¥ä½œæµç¨‹

### æ—¥å¸¸å¼€å‘æµç¨‹
```bash
# 1. ä»devåˆ†æ”¯åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout dev
git pull origin dev
git checkout -b feature/your-feature-name

# 2. å¼€å‘å®Œæˆååˆå¹¶åˆ°dev
git checkout dev
git merge feature/your-feature-name
git push origin dev

# 3. devæµ‹è¯•ç¨³å®šååˆå¹¶åˆ°main
git checkout main
git merge dev
git push origin main
```

### å‘å¸ƒæµç¨‹
```bash
# 1. ä»mainåˆ›å»ºreleaseåˆ†æ”¯
git checkout main
git pull origin main
git checkout -b release/v1.0.0

# 2. è¿›è¡Œå‘å¸ƒå‡†å¤‡å’Œbugä¿®å¤
# ... ä¿®å¤å…³é”®é—®é¢˜ ...

# 3. æ‰“æ ‡ç­¾å¹¶æ¨é€
git tag v1.0.0
git push origin release/v1.0.0
git push origin v1.0.0
```

### Cloudflare Workerséƒ¨ç½²æµç¨‹
```bash
# 1. åˆ‡æ¢åˆ°deployåˆ†æ”¯
git checkout deploy
git pull origin deploy

# 2. å¦‚æœéœ€è¦åŒæ­¥mainçš„å‰ç«¯å˜æ›´
git merge main --strategy-option=subtree=frontend

# 3. éƒ¨ç½²åˆ°Cloudflare Workers
cd frontend
npm install
npm run build
npm run deploy
```

## ğŸ›¡ï¸ åˆ†æ”¯ä¿æŠ¤è§„åˆ™

### mainåˆ†æ”¯ä¿æŠ¤
- å¯ç”¨åˆ†æ”¯ä¿æŠ¤
- è¦æ±‚PRå®¡æŸ¥
- è¦æ±‚çŠ¶æ€æ£€æŸ¥é€šè¿‡
- ä¸å…è®¸å¼ºåˆ¶æ¨é€

### releaseåˆ†æ”¯ä¿æŠ¤
- å‘å¸ƒåè®¾ç½®ä¸ºåªè¯»
- åªå…è®¸å…³é”®bugä¿®å¤çš„PR
- éœ€è¦ç»´æŠ¤è€…å®¡æ‰¹

## ğŸ“Š åˆ†æ”¯çŠ¶æ€ç›‘æ§

å®šæœŸæ£€æŸ¥å„åˆ†æ”¯çŠ¶æ€ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
git branch -a

# æŸ¥çœ‹åˆ†æ”¯æäº¤å†å²
git log --oneline --graph --all -10

# æŸ¥çœ‹åˆ†æ”¯é—´å·®å¼‚
git log main..dev --oneline
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **deployåˆ†æ”¯ç‰¹æ®Šæ€§**: 
   - å·²ä¸“é—¨ä¼˜åŒ–ä¸ºçº¯å‰ç«¯éƒ¨ç½²åˆ†æ”¯
   - ä¸åŒ…å«åç«¯ä»£ç å’ŒDockeré…ç½®
   - ä¸“ç”¨äºCloudflare Workerséƒ¨ç½²

2. **åˆå¹¶ç­–ç•¥**:
   - dev â†’ main: ä½¿ç”¨merge commitä¿æŒå†å²
   - main â†’ release: ä½¿ç”¨merge commit
   - é¿å…ä½¿ç”¨rebaseæ”¹å†™å…¬å…±å†å²

3. **å‘½åè§„èŒƒ**:
   - åŠŸèƒ½åˆ†æ”¯: `feature/åŠŸèƒ½åç§°`
   - ä¿®å¤åˆ†æ”¯: `fix/é—®é¢˜æè¿°`
   - å‘å¸ƒåˆ†æ”¯: `release/vç‰ˆæœ¬å·`

## ğŸ”§ åˆ†æ”¯ç»´æŠ¤

### å®šæœŸæ¸…ç†
- åˆ é™¤å·²åˆå¹¶çš„åŠŸèƒ½åˆ†æ”¯
- æ¸…ç†è¿‡æœŸçš„è¿œç¨‹è·Ÿè¸ªåˆ†æ”¯
```bash
git branch -d feature/completed-feature
git remote prune origin
```

### åŒæ­¥æ›´æ–°
- å®šæœŸå°†mainçš„å‰ç«¯å˜æ›´åŒæ­¥åˆ°deployåˆ†æ”¯
- ä¿æŒdevåˆ†æ”¯ä¸æœ€æ–°å¼€å‘è¿›åº¦ä¸€è‡´

---

**æœ€åæ›´æ–°**: 2024å¹´9æœˆ23æ—¥
**ç»´æŠ¤è€…**: zdwtest